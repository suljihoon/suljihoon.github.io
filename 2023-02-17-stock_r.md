```R
stock=read.csv("stockprice3.csv",header=T)


stock
head(stock)

stock=stock[2:8]

head(stock)
stock$name
```


```R
########bollinger function#################################################################################################################################################

#d=dataframe, n=name
Bollinger <-function(d,...){
  x<-d[d$name==...,]
  x=x[,5]
  day20=c()
  highboll=c()
  lowboll=c()
  for (i in 20:2500) {
    day20[i]=mean(x[i-1],x[i-2],x[i-3],x[i-4],x[i-5],x[i-6],x[i-7],x[i-8],x[i-9],x[i-10],x[i-11],x[i-12],x[i-13],x[i-14],x[i-15],x[i-16],x[i-17],x[i-18],x[i-19],x[i-20])
    a=sd(c(x[i-1],x[i-2],x[i-3],x[i-4],x[i-5],x[i-6],x[i-7],x[i-8],x[i-9],x[i-10],x[i-11],x[i-12],x[i-13],x[i-14],x[i-15],x[i-16],x[i-17],x[i-18],x[i-19],x[i-20]))
    highboll[i]=day20[i]+a*2
    lowboll[i]=day20[i]-a*2
  }
print(round(highboll,2))
print(round(lowboll,2))
}

Bollinger(stock,"삼성전자")
```


```R
###########대한해운###########################################################################################################################################################
sea=stock[stock$name=="대한해운",]
sea=sea[,2:8]
head(sea)


sea_close=sea[,4]

day20=c()
highboll=c()
lowboll=c()

  for (i in 20:2500) {
  day20[i]=mean(sea_close[i-1],sea_close[i-2],sea_close[i-3],sea_close[i-4],sea_close[i-5],sea_close[i-6],sea_close[i-7],sea_close[i-8],sea_close[i-9],sea_close[i-10],sea_close[i-11],sea_close[i-12],sea_close[i-13],sea_close[i-14],sea_close[i-15],sea_close[i-16],sea_close[i-17],sea_close[i-18],sea_close[i-19],sea_close[i-20])
  a=sd(c(sea_close[i-1],sea_close[i-2],sea_close[i-3],sea_close[i-4],sea_close[i-5],sea_close[i-6],sea_close[i-7],sea_close[i-8],sea_close[i-9],sea_close[i-10],sea_close[i-11],sea_close[i-12],sea_close[i-13],sea_close[i-14],sea_close[i-15],sea_close[i-16],sea_close[i-17],sea_close[i-18],sea_close[i-19],sea_close[i-20]))
  highboll[i]=day20[i]+a*2
  lowboll[i]=day20[i]-a*2
    }
day20
round(highboll,2)
round(lowboll,2)

day20[40]
sea[40,]

head(sea_close)

sea_boll<-cbind(sea,highboll,lowboll)

sea_boll
```


```R
#########일목균형표##################################################################################################################################################
sea

##전환선
sea_max9=c()
sea_min9=c()
line_trans=c()
for (i in 9:2500) {
   sea_max9[i]=max(sea_close[i-1],sea_close[i-2],sea_close[i-3],sea_close[i-4],sea_close[i-5],sea_close[i-6],sea_close[i-7],sea_close[i-8],sea_close[i-9])
   sea_min9[i]=min(sea_close[i-1],sea_close[i-2],sea_close[i-3],sea_close[i-4],sea_close[i-5],sea_close[i-6],sea_close[i-7],sea_close[i-8],sea_close[i-9])
   line_trans[i]=(sea_max9[i]+sea_min9[i])/2
   }
line_trans

##기준선
sea_max26=c()
sea_min26=c()
line_base=c()
for (i in 26:2500) {
  sea_max26[i]=max(sea_close[i-1],sea_close[i-2],sea_close[i-3],sea_close[i-4],sea_close[i-5],sea_close[i-6],sea_close[i-7],sea_close[i-8],sea_close[i-9],sea_close[i-10],
                   sea_close[i-11],sea_close[i-12],sea_close[i-13],sea_close[i-14],sea_close[i-15],sea_close[i-16],sea_close[i-17],sea_close[i-18],sea_close[i-19],
                   sea_close[i-20],sea_close[i-21],sea_close[i-22],sea_close[i-23],sea_close[i-24],sea_close[i-25],sea_close[i-26])
  
  sea_min26[i]=min(sea_close[i-1],sea_close[i-2],sea_close[i-3],sea_close[i-4],sea_close[i-5],sea_close[i-6],sea_close[i-7],sea_close[i-8],sea_close[i-9],sea_close[i-10],
                   sea_close[i-11],sea_close[i-12],sea_close[i-13],sea_close[i-14],sea_close[i-15],sea_close[i-16],sea_close[i-17],sea_close[i-18],sea_close[i-19],
                   sea_close[i-20],sea_close[i-21],sea_close[i-22],sea_close[i-23],sea_close[i-24],sea_close[i-25],sea_close[i-26])
  line_base[i]=(sea_max26[i]+sea_min26[i])/2
}
line_base

##선행스팬1
span_pre1=c()

for (i in 26:2500) {
  span_pre1[i+26]=(line_base[i]+line_trans[i])/2
}
span_pre1

##선행스팬2
sea_max52=c()
sea_min52=c()
span_pre2=c()

for (i in 52:2500){
  sea_max52[i]=max(sea_close[i-1],sea_close[i-2],sea_close[i-3],sea_close[i-4],sea_close[i-5],sea_close[i-6],sea_close[i-7],sea_close[i-8],sea_close[i-9],sea_close[i-10],
                   sea_close[i-11],sea_close[i-12],sea_close[i-13],sea_close[i-14],sea_close[i-15],sea_close[i-16],sea_close[i-17],sea_close[i-18],sea_close[i-19],
                   sea_close[i-20],sea_close[i-21],sea_close[i-22],sea_close[i-23],sea_close[i-24],sea_close[i-25],sea_close[i-26],sea_close[i-27],sea_close[i-28],
                   sea_close[i-29],sea_close[i-30],sea_close[i-31],sea_close[i-32],sea_close[i-33],sea_close[i-34],sea_close[i-35],sea_close[i-36],sea_close[i-37],sea_close[i-38],
                   sea_close[i-39],sea_close[i-40],sea_close[i-41],sea_close[i-42],sea_close[i-43],sea_close[i-44],sea_close[i-45],sea_close[i-46],sea_close[i-47],
                   sea_close[i-48],sea_close[i-49],sea_close[i-50],sea_close[i-51],sea_close[i-52])
  
  sea_min52[i]=min(sea_close[i-1],sea_close[i-2],sea_close[i-3],sea_close[i-4],sea_close[i-5],sea_close[i-6],sea_close[i-7],sea_close[i-8],sea_close[i-9],sea_close[i-10],
                   sea_close[i-11],sea_close[i-12],sea_close[i-13],sea_close[i-14],sea_close[i-15],sea_close[i-16],sea_close[i-17],sea_close[i-18],sea_close[i-19],
                   sea_close[i-20],sea_close[i-21],sea_close[i-22],sea_close[i-23],sea_close[i-24],sea_close[i-25],sea_close[i-26],sea_close[i-27],sea_close[i-28],
                   sea_close[i-29],sea_close[i-30],sea_close[i-31],sea_close[i-32],sea_close[i-33],sea_close[i-34],sea_close[i-35],sea_close[i-36],sea_close[i-37],sea_close[i-38],
                   sea_close[i-39],sea_close[i-40],sea_close[i-41],sea_close[i-42],sea_close[i-43],sea_close[i-44],sea_close[i-45],sea_close[i-46],sea_close[i-47],
                   sea_close[i-48],sea_close[i-49],sea_close[i-50],sea_close[i-51],sea_close[i-52])
  span_pre2[i]=(sea_max52[i]+sea_min52[i])/2
}
span_pre2

##후행스팬
  span_tra=c()
for (i in 1:2500) {
  span_tra[i]=sea_close[i+26]
}
span_tra
```


```R
########일목균형표 funxtion#################################################################################################################################################
stock=read.csv("stockprice3.csv",header=T,fileEncoding = 'euc-kr',encoding = 'utf-8')
stock
head(stock)
stock=stock[2:8]
head(stock)


Onejelly<-function(d,...){
  x=d[d$name==...,]
  x<-x[,5]
  X=d[d$name==...,]
  X<-X[,5]
  max9=c()
  min9=c()
  max26=c()
  min26=c()
  max52=c()
  min52=c()
  trans=c()
  base=c()
  pre1=c()
  pre2=c()
  tra=c()

  for (i in 9:2500) {
    max9[i]=max(x[i-1],x[i-2],x[i-3],x[i-4],x[i-5],x[i-6],x[i-7],x[i-8],x[i-9])
    min9[i]=min(x[i-1],x[i-2],x[i-3],x[i-4],x[i-5],x[i-6],x[i-7],x[i-8],x[i-9])
    trans[i]=(max9[i]+min9[i])/2
  }

  for (i in 26:2500) {
  max26[i]=max(x[i-1],x[i-2],x[i-3],x[i-4],x[i-5],x[i-6],x[i-7],x[i-8],x[i-9],x[i-10],
                                       x[i-11],x[i-12],x[i-13],x[i-14],x[i-15],x[i-16],x[i-17],x[i-18],x[i-19],
                                       x[i-20],x[i-21],x[i-22],x[i-23],x[i-24],x[i-25],x[i-26])
  
  min26[i]=min(x[i-1],x[i-2],x[i-3],x[i-4],x[i-5],x[i-6],x[i-7],x[i-8],x[i-9],x[i-10],
               x[i-11],x[i-12],x[i-13],x[i-14],x[i-15],x[i-16],x[i-17],x[i-18],x[i-19],
               x[i-20],x[i-21],x[i-22],x[i-23],x[i-24],x[i-25],x[i-26])
  base[i]=(max26[i]+min26[i])/2
  pre1[i+26]=(base[i]+trans[i])/2
  }
  
  for (i in 52:2500) {
  max52[i]=max(x[i-1],x[i-2],x[i-3],x[i-4],x[i-5],x[i-6],x[i-7],x[i-8],x[i-9],x[i-10],
                     x[i-11],x[i-12],x[i-13],x[i-14],x[i-15],x[i-16],x[i-17],x[i-18],x[i-19],
                     x[i-20],x[i-21],x[i-22],x[i-23],x[i-24],x[i-25],x[i-26],x[i-27],x[i-28],
                     x[i-29],x[i-30],x[i-31],x[i-32],x[i-33],x[i-34],X[i-35],x[i-36],x[i-37],
                     x[i-38],x[i-39],x[i-40],x[i-41],x[i-42],x[i-43],x[i-44],x[i-45],x[i-46],
                     x[i-47],x[i-48],x[i-49],x[i-50],x[i-51],x[i-52])
    
   min52[i]=min(x[i-1],x[i-2],x[i-3],x[i-4],x[i-5],x[i-6],x[i-7],x[i-8],X[i-9],x[i-10],
                     x[i-11],x[i-12],x[i-13],x[i-14],x[i-15],x[i-16],x[i-17],x[i-18],x[i-19],
                     x[i-20],x[i-21],x[i-22],x[i-23],x[i-24],x[i-25],x[i-26],x[i-27],x[i-28],
                     x[i-29],x[i-30],x[i-31],x[i-32],x[i-33],x[i-34],x[i-35],x[i-36],x[i-37],
                     x[i-38],x[i-39],x[i-40],x[i-41],x[i-42],x[i-43],x[i-44],x[i-45],x[i-46],
                     x[i-47],x[i-48],x[i-49],x[i-50],x[i-51],x[i-52])
    pre2[i]=(max52[i]+min52[i])/2
  }

  for (i in 1:2500) {
    tra[i]=x[i+26]
  }

  print(trans)
  print(base)
  print(pre1)
  print(pre2)
  print(tra)
}


Onejelly(stock,"대한해운")
```


```R
########한번에 출력 funxtion#################################################################################################################################################
stock=read.csv("stockprice3.csv",header=T,fileEncoding = 'euc-kr',encoding = 'utf-8')
stock
head(stock)
stock=stock[2:8]
head(stock)

stock_pri<-function(d,...){
  x=d[d$name==...,]
  x<-x[,5]
  X=d[d$name==...,]
  X<-X[,5]
  y=d[d$name==...,]
  max9=c()
  min9=c()
  max26=c()
  min26=c()
  max52=c()
  min52=c()
  line_trans=c()
  line_base=c()
  span_pre1=c()
  span_pre2=c()
  span_tra=c()
  day20=c()
  highboll=c()
  lowboll=c()
  highboll_26=c()
  lowboll_26=c()
  line_trans_26=c()
  line_base_26=c()
  span_pre1_26=c()
  span_pre2_26=c()
  span_tra_26=c()
  
  for (i in 20:2500) {
    day20[i]=mean(x[i-1],x[i-2],x[i-3],x[i-4],x[i-5],x[i-6],x[i-7],x[i-8],x[i-9],x[i-10],x[i-11],x[i-12],x[i-13],x[i-14],x[i-15],x[i-16],x[i-17],x[i-18],x[i-19],x[i-20])
    a=sd(c(x[i-1],x[i-2],x[i-3],x[i-4],x[i-5],x[i-6],x[i-7],x[i-8],x[i-9],x[i-10],x[i-11],x[i-12],x[i-13],x[i-14],x[i-15],x[i-16],x[i-17],x[i-18],x[i-19],x[i-20]))
    highboll[i]=day20[i]+a*2
    lowboll[i]=day20[i]-a*2
  }
  
  for (i in 9:2500) {
    max9[i]=max(x[i-1],x[i-2],x[i-3],x[i-4],x[i-5],x[i-6],x[i-7],x[i-8],x[i-9])
    min9[i]=min(x[i-1],x[i-2],x[i-3],x[i-4],x[i-5],x[i-6],x[i-7],x[i-8],x[i-9])
    line_trans[i]=(max9[i]+min9[i])/2
  }
  
  for (i in 26:2500) {
    max26[i]=max(x[i-1],x[i-2],x[i-3],x[i-4],x[i-5],x[i-6],x[i-7],x[i-8],x[i-9],x[i-10],
                 x[i-11],x[i-12],x[i-13],x[i-14],x[i-15],x[i-16],x[i-17],x[i-18],x[i-19],
                 x[i-20],x[i-21],x[i-22],x[i-23],x[i-24],x[i-25],x[i-26])
    
    min26[i]=min(x[i-1],x[i-2],x[i-3],x[i-4],x[i-5],x[i-6],x[i-7],x[i-8],x[i-9],x[i-10],
                 x[i-11],x[i-12],x[i-13],x[i-14],x[i-15],x[i-16],x[i-17],x[i-18],x[i-19],
                 x[i-20],x[i-21],x[i-22],x[i-23],x[i-24],x[i-25],x[i-26])
    line_base[i]=(max26[i]+min26[i])/2
    span_pre1[i+26]=(line_base[i]+line_trans[i])/2
  }
  
  for (i in 52:2500) {
    max52[i]=max(x[i-1],x[i-2],x[i-3],x[i-4],x[i-5],x[i-6],x[i-7],x[i-8],x[i-9],x[i-10],
                 x[i-11],x[i-12],x[i-13],x[i-14],x[i-15],x[i-16],x[i-17],x[i-18],x[i-19],
                 x[i-20],x[i-21],x[i-22],x[i-23],x[i-24],x[i-25],x[i-26],x[i-27],x[i-28],
                 x[i-29],x[i-30],x[i-31],x[i-32],x[i-33],x[i-34],X[i-35],x[i-36],x[i-37],
                 x[i-38],x[i-39],x[i-40],x[i-41],x[i-42],x[i-43],x[i-44],x[i-45],x[i-46],
                 x[i-47],x[i-48],x[i-49],x[i-50],x[i-51],x[i-52])
    
    min52[i]=min(x[i-1],x[i-2],x[i-3],x[i-4],x[i-5],x[i-6],x[i-7],x[i-8],X[i-9],x[i-10],
                 x[i-11],x[i-12],x[i-13],x[i-14],x[i-15],x[i-16],x[i-17],x[i-18],x[i-19],
                 x[i-20],x[i-21],x[i-22],x[i-23],x[i-24],x[i-25],x[i-26],x[i-27],x[i-28],
                 x[i-29],x[i-30],x[i-31],x[i-32],x[i-33],x[i-34],x[i-35],x[i-36],x[i-37],
                 x[i-38],x[i-39],x[i-40],x[i-41],x[i-42],x[i-43],x[i-44],x[i-45],x[i-46],
                 x[i-47],x[i-48],x[i-49],x[i-50],x[i-51],x[i-52])
    span_pre2[i]=(max52[i]+min52[i])/2
  }
  
  for (i in 1:2500) {
    span_tra[i]=x[i+26]
  }
  
  y_26=y[1:26,]
  y26=as.data.frame(y_26)
  
  
  for (j in 1:26) {
    today<-Sys.Date()
    b1<-format(today,format="%Y/%m/%d")
    a1=seq(as.Date(b1, '%Y/%m/%d'),as.Date('2022/12/31', '%Y/%m/%d'),+1) #현재 년도로 수정
    for (i in 26) {                                                      #ex)2023년 06월 10일->2023/12/31
      a1=a1[i]
    }
    a1=seq(as.Date(b1, '%Y/%m/%d'),as.Date(a1, '%Y/%m/%d'),+1)
    a1<-gsub("-", "", a1)
  }
  
  
  
  for (i in 1:26) {
    y_26$date[i]=0
    y_26$open[i]=0
    y_26$high[i]=0
    y_26$low[i]=0
    y_26$close[i]=0
    y_26$Volume[i]=0
  }
  
  y_26$date=a1
  
  y_2526=rbind(y,y_26)
  y_2526
  
  for (i in 2501:2526) {
    highboll[i]=0
    lowboll[i]=0
    line_trans[i]=0
    line_base[i]=0
    span_pre2[i]=0
    span_tra[i]=0
  }
  totall=cbind(y_2526,highboll,lowboll,line_trans, line_base, span_pre1, span_pre2, span_tra)
  totall=na.omit(totall)
  write.csv(totall[,1:13],file=paste(totall$name[1],".csv"))
  
}
totall=cbind(y_2526,highboll,lowboll,line_trans, line_base, span_pre1, span_pre2, span_tra)
totall=na.omit(totall)
write.csv(totall[,3:13],file=paste(totall$name[1],".csv"))


stock_pri(stock,"삼성전자")

```
